<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <!-- Ensures the page scales correctly on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Demo Registration Form</title>

    <!-- Google Font (Inter) -->
    <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap"
            rel="stylesheet"
    />

    <!-- Craftwork Grotesk font (if licensed) -->
    <link
            href="https://db.onlinewebfonts.com/c/08e8247441bb4ead56bb4fe018f44636?family=Craftwork+Grotesk"
            rel="stylesheet"
    />
    <style>
        @import url("https://db.onlinewebfonts.com/c/08e8247441bb4ead56bb4fe018f44636?family=Craftwork+Grotesk");
        @font-face {
            font-family: "Craftwork Grotesk";
            src: url("https://db.onlinewebfonts.com/t/08e8247441bb4ead56bb4fe018f44636.eot");
            src:
                    url("https://db.onlinewebfonts.com/t/08e8247441bb4ead56bb4fe018f44636.eot?#iefix") format("embedded-opentype"),
                    url("https://db.onlinewebfonts.com/t/08e8247441bb4ead56bb4fe018f44636.woff2") format("woff2"),
                    url("https://db.onlinewebfonts.com/t/08e8247441bb4ead56bb4fe018f44636.woff") format("woff"),
                    url("https://db.onlinewebfonts.com/t/08e8247441bb4ead56bb4fe018f44636.ttf") format("truetype"),
                    url("https://db.onlinewebfonts.com/t/08e8247441bb4ead56bb4fe018f44636.svg#Craftwork Grotesk") format("svg");
            font-weight: 600;
        }

        /* RESET / BASE STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Hide horizontal scroll */
        html, body {
            overflow-x: hidden;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(225deg, #192297 0%, #4B57FF 100%);
        }

        /* HEADER SECTION */
        .header-container {
            text-align: center;
            margin-top: 40px; /* Spacing from top */
        }

        .logo {
            width: 60px;
            height: auto;
            margin: 0 auto 8px;
            display: block;
        }

        .header-text {
            font-family: 'Craftwork Grotesk', sans-serif;
            font-size: 28px;
            font-weight: 600;
            line-height: 36px;
            color: #fff;
            margin-bottom: 8px;
        }

        .instruction-text {
            color: #A4C3FF;
            font-size: 16px;
            font-weight: 400;
            line-height: 24px;
            letter-spacing: -0.04em;
            text-align: center;
            max-width: 340px;
            margin: 0 auto 24px;
        }

        /* FORM SECTION */
        .form-container {
            background: #ffffff;
            border-radius: 24px;
            padding: 24px;
            max-width: 380px;
            width: 90%;
            margin-bottom: 40px;
        }

        .form-group {
            position: relative; /* Each group is relative so error text can be absolutely positioned */
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            font-size: 14px;
            color: #333;
        }

        /* Asterisk for required fields */
        .required-asterisk {
            color: red;
            margin-left: 2px;
        }

        .form-input {
            width: 100%;
            height: 50px;
            padding: 12px;
            border: 1px solid #E0E0E0;
            border-radius: 4px;
            background: #FFFFFF;
            font-size: 16px;
        }

        /* Error text style, absolutely positioned at top-right inside .form-group */
        .error-text {
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            font-size: 12px;
            line-height: 16px;
            letter-spacing: -0.02em; /* ~ -2% */
            text-align: right;
            background: #FF6A2A;
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;

            position: absolute;
            top: 25px;     /* just inside the group area */
            right: 2px;   /* small offset from right edge */
            display: none; /* Hidden by default */
            z-index: 2;   /* ensure it appears above the input */
        }

        .error-text.show {
            display: inline;
        }

        .submit-btn {
            width: 100%;
            height: 48px;
            background: #22CD48;
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s ease;
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* BOTTOM IMAGE SECTION */
        .bottom-image {
            width: 125%;
            max-width: 586px;
        }

        .bottom-image img {
            display: block;
            width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
<!-- HEADER -->
<div class="header-container">
    <img src="/images/aio_logo.png" alt="Logo" class="logo" />
    <h1 class="header-text">Demo Registration</h1>
    <p class="instruction-text">
        Fill out this form to schedule your <br />
        affiliate marketing demo
    </p>
</div>

<!-- FORM -->
<div class="form-container">
    <form id="demoForm" novalidate>

        <input type="hidden" name="chatId" id="chatId" />

        <!-- Required Email -->
        <div class="form-group">
            <label for="email">
                Email<span class="required-asterisk">*</span>
            </label>
            <input
                    type="email"
                    id="email"
                    name="email"
                    class="form-input"
                    placeholder="Your email"
                    required
            />
            <span class="error-text" id="email-error">Invalid email address</span>
        </div>

        <!-- Required Vertical -->
        <div class="form-group">
            <label for="vertical">
                Vertical<span class="required-asterisk">*</span>
            </label>
            <input
                    type="text"
                    id="vertical"
                    name="vertical"
                    class="form-input"
                    placeholder="Your vertical"
                    required
            />
            <span class="error-text" id="vertical-error">Vertical is required</span>
        </div>

        <!-- Not Required Message -->
        <div class="form-group">
            <label for="message">
                Additional Info
            </label>
            <input
                    type="text"
                    id="message"
                    name="message"
                    class="form-input"
                    placeholder="Additional info (optional)"
            />
            <span class="error-text" id="message-error">Message is required</span>
        </div>

        <button type="submit" class="submit-btn" disabled>Submit</button>
    </form>
</div>

<!-- BOTTOM IMAGE -->
<div class="bottom-image">
    <img src="/images/bottom_logo.png" alt="Background graphic" />
</div>

<!-- JS VALIDATION SCRIPT -->
<script>
    (function () {
        const form = document.getElementById('demoForm');
        const inputs = form.querySelectorAll('.form-input');
        const submitBtn = form.querySelector('.submit-btn');

        // Only required fields for button enable/disable
        const requiredInputs = Array.from(inputs).filter(i => i.hasAttribute('required'));

        // Simple email check
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // Simple phone check
        function isValidPhone(phone) {
            if (!phone) return true; // optional
            return /^[\d\s\-()]+$/.test(phone);
        }

        // Toggle error visibility
        function showError(inputId, message, show) {
            const errorSpan = document.getElementById(inputId + '-error');
            if (!errorSpan) return;
            errorSpan.textContent = message;
            errorSpan.classList.toggle('show', show);
        }
        // Update submit button based on required fields
        function updateSubmitButtonState() {
            let allFilled = true;
            requiredInputs.forEach(input => {
                if (!input.value.trim()) {
                    allFilled = false;
                }
            });
            submitBtn.disabled = !allFilled;
        }

        // Listen for input changes on required fields
        requiredInputs.forEach(input => {
            input.addEventListener('input', updateSubmitButtonState);
        });

        // Initial check for autofilled fields
        updateSubmitButtonState();

        // Final validation on submit
        // 1. Grab chatId from query string (?chatId=123, for example)
        const urlParams = new URLSearchParams(window.location.search);
        // 2. Put that chatId into the hidden input
        document.getElementById('chatId').value = urlParams.get('chatId') || '';

        // Basic function to check if required fields are non-empty
        function checkFieldValidity(input) {
            if (input.hasAttribute('required')) {
                return input.value.trim() !== '';
            } else return true;
        }

        form.addEventListener('submit', function(e) {
            e.preventDefault(); // stop normal form submission

            // Validate each required field
            let formIsValid = true;
            inputs.forEach(input => {
                if (!checkFieldValidity(input)) {
                    formIsValid = false;
                    alert(`${input.name} is required and cannot be blank.`);
                }
            });

            if (!formIsValid) return; // stop if invalid

            // 4. If valid, gather data and send via fetch
            const formData = new FormData(form); // includes message, email, vertical, chatId

            fetch('submit-demo.php', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.status}`);
                    }
                    return response.text(); // or response.json() if your server returns JSON
                })
                .then(result => {
                    // 5. Show server response to user
                    alert(result);
                })
                .catch(error => {
                    alert('An error occurred: ' + error.message);
                });
        });
    })();
</script>
</body>
</html>
